<!DOCTYPE html>
<html lang="en">
<head>
    <title>Rankings: {{ course.title }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
</head>
<body class="bg-slate-50 min-h-screen flex">

    <aside class="w-64 bg-white border-r border-slate-200 min-h-screen p-6 fixed">
        <div class="flex items-center gap-3 mb-8">
            <div class="w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center text-white"><i class="ph-bold ph-chalkboard-teacher"></i></div>
            <span class="font-bold text-lg text-slate-800">SkillTrack</span>
        </div>
        <a href="/instructor/gradebook" class="flex items-center gap-3 px-4 py-3 text-slate-500 hover:text-purple-700 font-bold block mb-2"><i class="ph-bold ph-arrow-left"></i> Back to Courses</a>
    </aside>

    <main class="ml-64 flex-1 p-8">
        
        <div class="flex justify-between items-end mb-8 bg-white p-6 rounded-xl shadow-sm border border-slate-200">
            <div>
                <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Course Analytics</p>
                <h1 class="text-3xl font-bold text-slate-800">{{ course.title }}</h1>
                <p class="text-slate-500 mt-1">{{ students|length }} Students Enrolled</p>
            </div>

            <form action="/instructor/export_csv/{{ course.id }}" method="GET" class="flex items-center gap-2">
                <div class="flex items-center gap-2 bg-slate-100 rounded-lg px-3 py-2 border border-slate-200">
                    <span class="text-xs font-bold text-slate-500 uppercase">Total CA:</span>
                    <input type="number" name="ca" value="40" class="w-12 bg-transparent font-bold text-slate-800 outline-none text-center">
                </div>
                <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-green-700 flex items-center gap-2 shadow-sm transition">
                    <i class="ph-bold ph-microsoft-excel-logo"></i> Export Data
                </button>
            </form>
        </div>

        <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
            <div class="p-4 border-b border-slate-100 bg-purple-50 flex items-center gap-2">
                <i class="ph-fill ph-trophy text-purple-600 text-xl"></i>
                <h3 class="font-bold text-purple-900">Class Leaderboard</h3>
            </div>
            
            <table class="w-full text-left">
                <thead class="bg-white text-xs font-bold text-slate-400 uppercase border-b border-slate-100">
                    <tr>
                        <th class="px-6 py-4 w-16">Rank</th>
                        <th class="px-6 py-4">Student Name</th>
                        <th class="px-6 py-4">Student ID</th>
                        <th class="px-6 py-4">Quizzes Taken</th>
                        <th class="px-6 py-4 text-right">Average Score</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-slate-50">
                    {% for s in students %}
                    <tr class="hover:bg-slate-50 transition group">
                        <td class="px-6 py-4">
                            {% if loop.index == 1 %}
                                <span class="w-8 h-8 rounded-full bg-yellow-100 text-yellow-700 flex items-center justify-center font-bold">1</span>
                            {% elif loop.index == 2 %}
                                <span class="w-8 h-8 rounded-full bg-slate-200 text-slate-700 flex items-center justify-center font-bold">2</span>
                            {% elif loop.index == 3 %}
                                <span class="w-8 h-8 rounded-full bg-orange-100 text-orange-800 flex items-center justify-center font-bold">3</span>
                            {% else %}
                                <span class="text-slate-400 font-bold ml-2">#{{ loop.index }}</span>
                            {% endif %}
                        </td>
                        <td class="px-6 py-4">
                            <div class="font-bold text-slate-700">{{ s.name }}</div>
                            <div class="text-xs text-slate-400">{{ s.email }}</div>
                        </td>
                        <td class="px-6 py-4 font-mono text-sm text-slate-500">{{ s.school_id }}</td>
                        <td class="px-6 py-4">
                            <span class="bg-slate-100 text-slate-600 px-2 py-1 rounded text-xs font-bold">{{ s.quizzes_taken }}</span>
                        </td>
                        <td class="px-6 py-4 text-right">
                            <span class="text-lg font-bold 
                                {% if s.average >= 70 %} text-green-600 
                                {% elif s.average >= 50 %} text-yellow-600 
                                {% else %} text-red-600 {% endif %}">
                                {{ s.average }}%
                            </span>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="5" class="px-6 py-12 text-center text-slate-400">
                            No students enrolled in this course yet.
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

    </main>
</body>
</html>